# VTE - å¤šåç«¯ LLM API ç½‘å…³

[English](README.md) | [ç®€ä½“ä¸­æ–‡](README.zh-CN.md)

è½»é‡çº§ã€è‡ªæ‰˜ç®¡çš„ API ç½‘å…³ï¼Œç»Ÿä¸€ç®¡ç†å¤šä¸ª AI æœåŠ¡æä¾›å•†ï¼Œæä¾› OpenAI å…¼å®¹æ¥å£ã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

- ğŸ”Œ **å¤šåç«¯æ”¯æŒ** - æ”¯æŒä»»æ„ OpenAI å…¼å®¹ APIï¼ˆOpenAIã€Claudeã€Geminiã€Ollama ç­‰ï¼‰
- ğŸ¯ **æ¨¡å‹ç®¡ç†** - ä»æä¾›å•†æ‹‰å–æ¨¡å‹ï¼Œé€‰æ‹©æ€§å¯ç”¨
- ğŸ”‘ **ç»Ÿä¸€å…¥å£** - ä¸€ä¸ª URL + API Key ç®¡ç†æ‰€æœ‰ AI æœåŠ¡
- ğŸ–¥ï¸ **Web ç®¡ç†ç•Œé¢** - ç¾è§‚çš„ Web ç•Œé¢ï¼Œè½»æ¾ç®¡ç†
- ğŸ“‹ **å®æ—¶æ—¥å¿—** - ç»ˆç«¯é£æ ¼æ—¥å¿—ï¼Œæ–¹ä¾¿è°ƒè¯•
- ğŸ”„ **æµå¼æ§åˆ¶** - å…¨å±€å¼ºåˆ¶æµå¼æˆ–éæµå¼æ¨¡å¼
- ğŸ·ï¸ **æ¨¡å‹å‰ç¼€** - ä½¿ç”¨è‡ªå®šä¹‰å‰ç¼€ç»„ç»‡ä¸åŒæä¾›å•†çš„æ¨¡å‹
- ğŸ“Š **Tokenç»Ÿè®¡** - è¿½è¸ªæ¯æ—¥tokenæ¶ˆè€—ï¼ŒæŒ‰å°æ—¶åˆ†ç»„æ˜¾ç¤ºä½¿ç”¨é‡å’Œè¯·æ±‚æ¬¡æ•°
- ğŸ” **å®‰å…¨å¯é ** - å†…ç½®èº«ä»½éªŒè¯å’Œ API Key ç®¡ç†

---

## ğŸš€ Docker éƒ¨ç½²ï¼ˆæ¨èï¼‰

**æœ€ç®€å•çš„æ–¹å¼ï¼š**
```bash
docker run -d \
  --name vte \
  -p 8050:8050 \
  -v vte-data:/app/data \
  --restart unless-stopped \
  rtyedfty/vte
```

ç„¶åè®¿é—® http://ä½ çš„IP:8050ï¼Œé»˜è®¤è´¦å· `admin` / `admin123`

**è‡ªå®šä¹‰ç«¯å£å’Œå¯†ç ï¼š**
```bash
docker run -d \
  --name vte \
  -p 80:8050 \
  -v vte-data:/app/data \
  -e ADMIN_PASSWORD=mypassword123 \
  --restart unless-stopped \
  rtyedfty/vte
```

**å‚æ•°è¯´æ˜ï¼š**
| å‚æ•° | è¯´æ˜ | æ˜¯å¦å¿…é¡» |
|------|------|----------|
| `-p 8050:8050` | ç«¯å£æ˜ å°„ï¼Œæ”¹å·¦è¾¹æ•°å­—æ¢ç«¯å£ | å¿…é¡» |
| `-v vte-data:/app/data` | æ•°æ®æŒä¹…åŒ– | å»ºè®® |
| `-e ADMIN_PASSWORD=xxx` | è‡ªå®šä¹‰ç®¡ç†å‘˜å¯†ç  | å¯é€‰ |
| `-e SECRET_KEY=xxx` | JWT å¯†é’¥ | å¯é€‰ |
| `-e TZ=Asia/Shanghai` | æ—¶åŒºè®¾ç½®ï¼ˆé»˜è®¤åŒ—äº¬æ—¶é—´ï¼‰ | å¯é€‰ |
| `--restart unless-stopped` | è‡ªåŠ¨é‡å¯ | å»ºè®® |

**ä½¿ç”¨ docker-composeï¼š**

åˆ›å»º `docker-compose.yml`ï¼š
```yaml
version: '3.8'
services:
  vte:
    image: rtyedfty/vte
    ports:
      - "8050:8050"
    volumes:
      - vte-data:/app/data
    restart: unless-stopped

volumes:
  vte-data:
```

è¿è¡Œï¼š
```bash
docker-compose up -d
```

**æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬ï¼š**

âš ï¸ **é‡è¦æç¤º**ï¼š
1. æ›´æ–°æ—¶å¿…é¡»ä½¿ç”¨ `-v vte-data:/app/data` æŒ‚è½½æ•°æ®å·
2. æ›´æ–°å‰å»ºè®®å…ˆåœ¨è®¾ç½®é¡µé¢å¤åˆ¶ä¿å­˜ä½ çš„ API Key

ä½¿ç”¨æ›´æ–°è„šæœ¬ï¼ˆæ¨èï¼‰ï¼š
```bash
# Linux/Mac
chmod +x update.sh && ./update.sh

# Windows
update.bat
```

æˆ–æ‰‹åŠ¨æ›´æ–°ï¼š
```bash
# æ‹‰å–æœ€æ–°é•œåƒ
docker pull rtyedfty/vte:latest

# åœæ­¢å¹¶åˆ é™¤æ—§å®¹å™¨
docker stop vte && docker rm vte

# å¯åŠ¨æ–°å®¹å™¨ï¼ˆæ•°æ®ä¼šä¿ç•™ï¼‰
docker run -d --name vte -p 8050:8050 -v vte-data:/app/data --restart unless-stopped rtyedfty/vte:latest
```

**æ£€æŸ¥æ•°æ®å·æ˜¯å¦æ­£ç¡®æŒ‚è½½ï¼š**
```bash
docker inspect vte | grep vte-data
```
åº”è¯¥çœ‹åˆ° `/app/data` æŒ‚è½½åˆ° `vte-data` å·

---

## ğŸ’» æœ¬åœ°éƒ¨ç½²

**å¯åŠ¨æœåŠ¡ï¼ˆè‡ªåŠ¨æ„å»ºï¼‰ï¼š**

Windowsï¼š
```cmd
start.bat
```

Linux/Macï¼š
```bash
chmod +x start.sh && ./start.sh
```

è„šæœ¬ä¼šè‡ªåŠ¨ï¼š
- æ£€æŸ¥å¹¶å®‰è£…ä¾èµ–ï¼ˆGoã€Node.jsï¼‰
- å®‰è£…/æ›´æ–°å‰ç«¯ä¾èµ–
- æ„å»ºå‰ç«¯å’Œåç«¯
- å¯åŠ¨æœåŠ¡

**åœæ­¢æœåŠ¡ï¼š** æŒ‰ `Ctrl+C` æˆ–ç›´æ¥å…³é—­çª—å£

**æ‰‹åŠ¨æ„å»ºï¼š**
```bash
# æ„å»ºå‰ç«¯
cd frontend && npm install && npm run build

# æ„å»ºåç«¯
cd ../backend && go mod tidy && go build -o vte .

# è¿è¡Œ
./vte
```

---

## ğŸ“– å¿«é€Ÿå¼€å§‹

### 1. è®¿é—® Web ç•Œé¢
è®¿é—® http://127.0.0.1:8050 å¹¶ä½¿ç”¨é»˜è®¤è´¦å·ç™»å½•ï¼š
- ç”¨æˆ·åï¼š`admin`
- å¯†ç ï¼š`admin123`

### 2. æ·»åŠ æä¾›å•†
- ç‚¹å‡»"æ·»åŠ æä¾›å•†"æŒ‰é’®
- é€‰æ‹©æä¾›å•†ç±»å‹ï¼ˆæ ‡å‡† OpenAI å…¼å®¹ / Vertex Expressï¼‰
- å¡«å†™æä¾›å•†ä¿¡æ¯ï¼š
  - **åç§°**ï¼šæ˜¾ç¤ºåç§°ï¼ˆå¦‚ OpenAIã€Claudeï¼‰
  - **æ¨¡å‹å‰ç¼€**ï¼šå¯é€‰çš„æ¨¡å‹åç§°å‰ç¼€ï¼ˆå¦‚ `openai`ã€`claude`ï¼‰
  - **API åœ°å€**ï¼šæä¾›å•†çš„ API ç«¯ç‚¹ï¼ˆå¿…é¡»åŒ…å« `/v1`ï¼‰
  - **API Key**ï¼šæä¾›å•†çš„ API å¯†é’¥

### 3. æ‹‰å–æ¨¡å‹
- ç‚¹å‡»æä¾›å•†çš„"æ‹‰å–æ¨¡å‹"æŒ‰é’®
- æ¨¡å‹ä¼šè‡ªåŠ¨å¯¼å…¥
- å¯ç”¨ä½ æƒ³ä½¿ç”¨çš„æ¨¡å‹

### 4. ä½¿ç”¨ API
ä»ä»ªè¡¨ç›˜æˆ–è®¾ç½®é¡µé¢å¤åˆ¶ä½ çš„ API Keyï¼Œç„¶åé…ç½®å®¢æˆ·ç«¯ï¼š

**API ç«¯ç‚¹**ï¼š`http://127.0.0.1:8050/v1`

**curl ç¤ºä¾‹**ï¼š
```bash
curl http://127.0.0.1:8050/v1/chat/completions \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "model": "gpt-4",
    "messages": [{"role": "user", "content": "ä½ å¥½ï¼"}]
  }'
```

**Python ç¤ºä¾‹**ï¼š
```python
from openai import OpenAI

client = OpenAI(
    base_url="http://127.0.0.1:8050/v1",
    api_key="YOUR_API_KEY"
)

response = client.chat.completions.create(
    model="gpt-4",
    messages=[{"role": "user", "content": "ä½ å¥½ï¼"}]
)
print(response.choices[0].message.content)
```

---

## âš™ï¸ é«˜çº§åŠŸèƒ½

### æµå¼æ¨¡å¼æ§åˆ¶
è¿›å…¥è®¾ç½® â†’ æµå¼æ¨¡å¼ï¼Œæ§åˆ¶æµå¼è¡Œä¸ºï¼š
- **è‡ªåŠ¨**ï¼šè·Ÿéšå®¢æˆ·ç«¯è¯·æ±‚ï¼ˆé»˜è®¤ï¼‰
- **å¼ºåˆ¶æµå¼**ï¼šæ‰€æœ‰è¯·æ±‚ä½¿ç”¨æµå¼
- **å¼ºåˆ¶éæµå¼**ï¼šæ‰€æœ‰è¯·æ±‚ä½¿ç”¨éæµå¼

### æ¨¡å‹å‰ç¼€
æ·»åŠ å‰ç¼€æ¥ç»„ç»‡ä¸åŒæä¾›å•†çš„æ¨¡å‹ï¼š
- åˆ›å»º/ç¼–è¾‘æä¾›å•†æ—¶è®¾ç½®å‰ç¼€ï¼ˆå¦‚ `openai`ã€`claude`ï¼‰
- æ¨¡å‹ä¼šæ˜¾ç¤ºä¸º `å‰ç¼€/æ¨¡å‹å`
- å¸®åŠ©è¯†åˆ«æ¨¡å‹å±äºå“ªä¸ªæä¾›å•†

### æ¨¡å‹åŒæ­¥
ç‚¹å‡»"æ‹‰å–æ¨¡å‹"ä¼šï¼š
- æ·»åŠ æä¾›å•†çš„æ–°æ¨¡å‹
- æ›´æ–°æ¨¡å‹æ˜¾ç¤ºåç§°ï¼ˆå¦‚æœå‰ç¼€æ”¹å˜ï¼‰
- åˆ é™¤å·²ä¸‹çº¿çš„æ¨¡å‹

---

## ğŸ”§ é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡

| å˜é‡ | è¯´æ˜ | é»˜è®¤å€¼ |
|------|------|--------|
| `ADMIN_PASSWORD` | ç®¡ç†å‘˜è´¦å·å¯†ç  | `admin123` |
| `SECRET_KEY` | JWT è®¤è¯å¯†é’¥ | è‡ªåŠ¨ç”Ÿæˆ |
| `DATABASE_PATH` | SQLite æ•°æ®åº“æ–‡ä»¶è·¯å¾„ | `./data/gateway.db` |

### Docker æ•°æ®å·

æŒ‚è½½ `/app/data` ä»¥æŒä¹…åŒ–ï¼š
- æ•°æ®åº“ï¼ˆç”¨æˆ·è´¦å·ã€æä¾›å•†ã€æ¨¡å‹ï¼‰
- é…ç½®è®¾ç½®

---

## ğŸŒ æ”¯æŒçš„æä¾›å•†

VTE æ”¯æŒä»»ä½• OpenAI å…¼å®¹çš„ APIã€‚ä»¥ä¸‹æ˜¯ä¸€äº›ç¤ºä¾‹ï¼š

| æä¾›å•† | ç±»å‹ | API åœ°å€ | å¤‡æ³¨ |
|--------|------|----------|------|
| OpenAI | æ ‡å‡† | `https://api.openai.com/v1` | å®˜æ–¹ OpenAI API |
| Anthropic Claude | æ ‡å‡† | `https://api.anthropic.com/v1` | Claude API |
| Google Gemini | Vertex Express | æ—  | éœ€è¦é¡¹ç›® ID |
| Ollama | æ ‡å‡† | `http://localhost:11434/v1` | æœ¬åœ°æ¨¡å‹ |
| Azure OpenAI | æ ‡å‡† | `https://{resource}.openai.azure.com/v1` | Azure ç«¯ç‚¹ |
| ä»»ä½•å…¼å®¹ API | æ ‡å‡† | è‡ªå®šä¹‰ URL | è‡ªæ‰˜ç®¡æˆ–ç¬¬ä¸‰æ–¹ |

---

## ğŸ› ï¸ å¼€å‘æŒ‡å—

### ç¯å¢ƒè¦æ±‚
- Go 1.21+
- Node.js 18+

### å®‰è£…æ­¥éª¤
```bash
# å…‹éš†ä»“åº“
git clone https://github.com/starared/vte.git
cd vte

# æ„å»ºå‰ç«¯
cd frontend
npm install
npm run build

# æ„å»ºåç«¯
cd ../backend
go mod tidy
go build -o vte .

# è¿è¡Œ
./vte
```

### é¡¹ç›®ç»“æ„
```
vte/
â”œâ”€â”€ backend/             # Go åç«¯
â”‚   â”œâ”€â”€ internal/
â”‚   â”‚   â”œâ”€â”€ models/      # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ handlers/    # API å¤„ç†å™¨
â”‚   â”‚   â”œâ”€â”€ database/    # æ•°æ®åº“
â”‚   â”‚   â””â”€â”€ router/      # è·¯ç”±
â”‚   â”œâ”€â”€ main.go          # å…¥å£
â”‚   â””â”€â”€ go.mod
â”œâ”€â”€ frontend/            # Vue å‰ç«¯
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ views/       # é¡µé¢
â”‚   â”‚   â”œâ”€â”€ api/         # API å®¢æˆ·ç«¯
â”‚   â”‚   â””â”€â”€ stores/      # çŠ¶æ€ç®¡ç†
â”‚   â””â”€â”€ package.json
â””â”€â”€ Dockerfile
```

---

## ğŸ“ æ›´æ–°æ—¥å¿—

### æœ€æ–°ç‰ˆæœ¬
- âœ… CORS è·¨åŸŸæ”¯æŒ
- âœ… WebSocket æ”¯æŒï¼ˆ`/v1/chat/completions/ws`ï¼‰
- âœ… åˆ‡æ¢åˆ°æ¨¡å‹ç®¡ç†é¡µé¢æ—¶è‡ªåŠ¨åŒæ­¥å‰ç¼€
- âœ… æµå¼æ¨¡å¼æ§åˆ¶ï¼ˆè‡ªåŠ¨/å¼ºåˆ¶æµå¼/å¼ºåˆ¶éæµå¼ï¼‰
- âœ… æ¨¡å‹å‰ç¼€æ”¯æŒï¼Œæ›´å¥½åœ°ç»„ç»‡æ¨¡å‹
- âœ… Vertex Express æ”¯æŒ
- âœ… API Key æ˜¾ç¤º/éšè—åˆ‡æ¢
- âœ… å®æ—¶æ—¥å¿—æŸ¥çœ‹å™¨

---

## ğŸ¤ è´¡çŒ®

æ¬¢è¿è´¡çŒ®ï¼è¯·éšæ—¶æäº¤ Pull Requestã€‚

---

## ğŸ“„ è®¸å¯è¯

MIT License - è¯¦è§ LICENSE æ–‡ä»¶

---

## ğŸ”— ç›¸å…³é“¾æ¥

- GitHubï¼š[starared/vte](https://github.com/starared/vte)
- Docker Hubï¼š[rtyedfty/vte](https://hub.docker.com/r/rtyedfty/vte)

---

## âš ï¸ å®‰å…¨æç¤º

- é¦–æ¬¡ç™»å½•åç«‹å³ä¿®æ”¹é»˜è®¤ç®¡ç†å‘˜å¯†ç 
- ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ HTTPSï¼ˆå»ºè®®ä½¿ç”¨åå‘ä»£ç†ï¼‰
- å¦¥å–„ä¿ç®¡ API å¯†é’¥
- å®šæœŸå¤‡ä»½æ•°æ®åº“ï¼ˆ`/app/data/gateway.db`ï¼‰
